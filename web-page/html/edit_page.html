<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Sports</title>
    <link rel="stylesheet" href="../css/edit.css">
</head>
<body>
    <div class="container">
        <div class="form-wrapper">
            <h1 id="pageTitle">Edit Sport</h1>
            
            <div id="singleSportEdit" style="display: none;">
                <form id="editForm">
                    <div class="form-group">
                        <label for="sportName">Sport Name:</label>
                        <input type="text" id="sportName" name="sportName" required placeholder="Enter sport name">
                    </div>

                    <div class="form-group">
                        <label for="proficiency">Proficiency Level:</label>
                        <select id="proficiency" name="proficiency" required>
                            <option value="">Select proficiency level</option>
                            <option value="Beginner">Beginner</option>
                            <option value="Intermediate">Intermediate</option>
                            <option value="Advanced">Advanced</option>
                            <option value="Professional">Professional</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="frequency">Practice Frequency:</label>
                        <select id="frequency" name="frequency" required>
                            <option value="">Select frequency</option>
                            <option value="Daily">Daily</option>
                            <option value="Weekly">Weekly</option>
                            <option value="Monthly">Monthly</option>
                            <option value="Occasionally">Occasionally</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="notes">Notes:</label>
                        <textarea id="notes" name="notes" rows="4" placeholder="Add any notes about this sport..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Update Sport</button>
                        <button type="button" class="btn btn-danger" onclick="deleteSingleSport()">Delete Sport</button>
                        <button type="button" class="btn btn-secondary" onclick="goBack()">Cancel</button>
                    </div>
                </form>
            </div>

            <div id="allSportsEdit" style="display: none;">
                <h2 style="margin-bottom: 25px; color: #555;">Manage All Sports</h2>
                <div id="allSportsList" class="all-sports-list">
                    <!-- All sports will be populated here -->
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" onclick="addNewSport()">Add New Sport</button>
                    <button class="btn btn-secondary" onclick="goBack()">Back</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const personId = urlParams.get('personId');
        const sportName = urlParams.get('sport');
        const editAll = urlParams.get('editAll');

        // Sample data
        const peopleData = [
            {
                id: 1,
                name: 'John Doe',
                email: 'john@example.com',
                phone: '+1-234-567-8900',
                sports: ['Cricket', 'Football', 'Basketball', 'Tennis']
            },
            {
                id: 2,
                name: 'Jane Smith',
                email: 'jane@example.com',
                phone: '+1-234-567-8901',
                sports: ['Swimming', 'Badminton', 'Volleyball']
            },
            {
                id: 3,
                name: 'Mike Johnson',
                email: 'mike@example.com',
                phone: '+1-234-567-8902',
                sports: ['Cricket', 'Swimming', 'Boxing']
            }
        ];

        const currentPerson = peopleData.find(p => p.id == personId);

        if (editAll === 'true') {
            loadAllSportsEdit();
        } else {
            loadSingleSportEdit();
        }

        function loadSingleSportEdit() {
            document.getElementById('pageTitle').textContent = `Edit Sport - ${currentPerson.name}`;
            document.getElementById('singleSportEdit').style.display = 'block';
            document.getElementById('allSportsEdit').style.display = 'none';

            document.getElementById('sportName').value = sportName || '';

            document.getElementById('editForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const oldIndex = currentPerson.sports.indexOf(sportName);
                if (oldIndex > -1) {
                    currentPerson.sports[oldIndex] = document.getElementById('sportName').value;
                }

                alert('Sport updated successfully!');
                goBack();
            });
        }

        function loadAllSportsEdit() {
            document.getElementById('pageTitle').textContent = `Manage Sports - ${currentPerson.name}`;
            document.getElementById('singleSportEdit').style.display = 'none';
            document.getElementById('allSportsEdit').style.display = 'block';

            const sportsListContainer = document.getElementById('allSportsList');
            sportsListContainer.innerHTML = '';

            currentPerson.sports.forEach((sport, index) => {
                const sportItem = document.createElement('div');
                sportItem.className = 'sport-item';
                sportItem.innerHTML = `
                    <div class="sport-item-info">
                        <h4>${sport}</h4>
                    </div>
                    <button type="button" class="btn-remove" onclick="removeSport(${index})">Remove</button>
                `;
                sportsListContainer.appendChild(sportItem);
            });
        }

        function deleteSingleSport() {
            if (confirm(`Are you sure you want to delete ${sportName}?`)) {
                const index = currentPerson.sports.indexOf(sportName);
                if (index > -1) {
                    currentPerson.sports.splice(index, 1);
                }
                alert('Sport deleted successfully!');
                goBack();
            }
        }

        function removeSport(index) {
            const sport = currentPerson.sports[index];
            if (confirm(`Remove ${sport} from interests?`)) {
                currentPerson.sports.splice(index, 1);
                loadAllSportsEdit();
                alert('Sport removed successfully!');
            }
        }

        function addNewSport() {
            const allAvailableSports = ['Cricket', 'Football', 'Basketball', 'Tennis', 'Volleyball', 'Badminton', 'Swimming', 'Boxing'];
            const availableSports = allAvailableSports.filter(s => !currentPerson.sports.includes(s));

            if (availableSports.length === 0) {
                alert('All available sports have been added!');
                return;
            }

            const sportToAdd = prompt(`Select a sport to add:\n\n${availableSports.join('\n')}`);
            
            if (sportToAdd && availableSports.includes(sportToAdd)) {
                if (!currentPerson.sports.includes(sportToAdd)) {
                    currentPerson.sports.push(sportToAdd);
                    loadAllSportsEdit();
                    alert('Sport added successfully!');
                }
            }
        }

        function goBack() {
            window.location.href = 'view_page.html';
        }
    </script>
</body>
</html>